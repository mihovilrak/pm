npm warn cli npm v11.2.0 does not support Node.js v22.7.0. This version of npm supports the following node versions: `^20.17.0 || >=22.9.0`. You can find the latest version at https://nodejs.org/.
npm warn Unknown cli config "--testPathPattern". This will stop working in the next major version of npm.
npm warn Unknown cli config "--coverage". This will stop working in the next major version of npm.

> project-management-backend@1.0.0 test
> jest --config src/__tests__/jest.config.ts

  console.error
    Error fetching activity types: Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\activityTypeController.test.ts:96:77)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      18 |     res.status(200).json(activityTypes);
      19 |   } catch (error) {
    > 20 |     console.error('Error fetching activity types:', error);
         |             ^
      21 |     res.status(500).json({ error: 'Failed to fetch activity types' });
      22 |   }
      23 | };

      at Object.error [as getActivityTypes] (controllers/activityTypeController.ts:20:13)
      at Object.<anonymous> (controllers/__tests__/activityTypeController.test.ts:97:9)

  console.error
    Error deleting activity type: Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\activityTypeController.test.ts:244:77)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      111 |     res.status(200).json({ message: 'Activity type deleted successfully' });
      112 |   } catch (error) {
    > 113 |     console.error('Error deleting activity type:', error);
          |             ^
      114 |     res.status(500).json({ error: 'Failed to delete activity type' });
      115 |   }
      116 | };

      at Object.error [as deleteActivityType] (controllers/activityTypeController.ts:113:13)
      at Object.<anonymous> (controllers/__tests__/activityTypeController.test.ts:246:7)

FAIL src/controllers/__tests__/activityTypeController.test.ts (18.679 s)
  ActivityTypeController
    getActivityTypes
      ΓêÜ should return activity types (43 ms)
      ├ù should handle errors appropriately (281 ms)
    createActivityType
      ├ù should create an activity type (4 ms)
      ├ù should return 400 if the user is not authenticated (3 ms)
      ΓêÜ should return 400 when color is not a valid hex color (12 ms)
    updateActivityType
      ├ù should update an activity type successfully (17 ms)
      ΓêÜ shoul return 404 when activity type is not found (3 ms)
    deleteActivityType
      ├ù should delete an activity type successfully (5 ms)
      ├ù should handle errors appropriately (17 ms)
    getAvailableIcons
      ├ù should return a list of available icons (3 ms)
      ├ù should handle errors appropriately (1 ms)

  ΓùÅ ActivityTypeController ΓÇ║ getActivityTypes ΓÇ║ should handle errors appropriately

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    - Expected
    + Received

      Object {
    -   "error": "Internal server error",
    +   "error": "Failed to fetch activity types",
      },

    Number of calls: 1

      102 |       expect(activityTypeModel.getActivityTypes).toHaveBeenCalledWith(mockPool);
      103 |       expect(mockRes.status).toHaveBeenCalledWith(500);
    > 104 |       expect(mockRes.json).toHaveBeenCalledWith({ error: 'Internal server error' });
          |                            ^
      105 |     });
      106 |   });
      107 |

      at Object.<anonymous> (controllers/__tests__/activityTypeController.test.ts:104:28)

  ΓùÅ ActivityTypeController ΓÇ║ createActivityType ΓÇ║ should create an activity type

    expect(jest.fn()).toHaveBeenCalled()

    Expected number of calls: >= 1
    Received number of calls:    0

      129 |         );
      130 |
    > 131 |       expect(activityTypeModel.createActivityType).toHaveBeenCalled();
          |                                                    ^
      132 |       expect(activityTypeModel.createActivityType).toHaveBeenCalledWith(mockPool, mockActivityTypeData);
      133 |       expect(mockRes.status).toHaveBeenCalledWith(201);
      134 |       expect(mockRes.json).toHaveBeenCalledWith(createdActivityType);

      at Object.<anonymous> (controllers/__tests__/activityTypeController.test.ts:131:52)

  ΓùÅ ActivityTypeController ΓÇ║ createActivityType ΓÇ║ should return 400 if the user is not authenticated

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: 400
    Received: 401

    Number of calls: 1

      146 |       );
      147 |
    > 148 |       expect(mockRes.status).toHaveBeenCalledWith(400);
          |                              ^
      149 |       expect(mockRes.json).toHaveBeenCalledWith(
      150 |         expect.objectContaining({
      151 |           error: 'User not authenticated'

      at Object.<anonymous> (controllers/__tests__/activityTypeController.test.ts:148:30)

  ΓùÅ ActivityTypeController ΓÇ║ updateActivityType ΓÇ║ should update an activity type successfully

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    - Expected
    + Received

      {},
      "1",
    - {"name": "Updated Activity Type"},
    + "Updated Activity Type",
    + "",
    + "",
    + "",

    Number of calls: 1

      202 |       );
      203 |
    > 204 |       expect(activityTypeModel.updateActivityType).toHaveBeenCalledWith(mockPool, activityTypeId, mockUpdateData);
          |                                                    ^
      205 |       expect(mockRes.status).toHaveBeenCalledWith(200);
      206 |       expect(mockRes.json).toHaveBeenCalledWith(updatedActivityType);
      207 |     });

      at Object.<anonymous> (controllers/__tests__/activityTypeController.test.ts:204:52)

  ΓùÅ ActivityTypeController ΓÇ║ deleteActivityType ΓÇ║ should delete an activity type successfully

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    - Expected
    + Received

      Object {
    -   "success": true,
    +   "message": "Activity type deleted successfully",
      },

    Number of calls: 1

      237 |       expect(activityTypeModel.deleteActivityType).toHaveBeenCalledWith(mockPool, activityTypeId);
      238 |       expect(mockRes.status).toHaveBeenCalledWith(200);
    > 239 |       expect(mockRes.json).toHaveBeenCalledWith({ success: true });
          |                            ^
      240 |     });
      241 |
      242 |     it('should handle errors appropriately', async () => {

      at Object.<anonymous> (controllers/__tests__/activityTypeController.test.ts:239:28)

  ΓùÅ ActivityTypeController ΓÇ║ deleteActivityType ΓÇ║ should handle errors appropriately

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    - Expected
    + Received

      Object {
    -   "error": "Internal server error",
    +   "error": "Failed to delete activity type",
      },

    Number of calls: 1

      251 |
      252 |       expect(mockRes.status).toHaveBeenCalledWith(500);
    > 253 |       expect(mockRes.json).toHaveBeenCalledWith({ error: 'Internal server error' });
          |                            ^
      254 |     });
      255 |   });
      256 |

      at Object.<anonymous> (controllers/__tests__/activityTypeController.test.ts:253:28)

  ΓùÅ ActivityTypeController ΓÇ║ getAvailableIcons ΓÇ║ should return a list of available icons

    TypeError: activityTypeController.getAvailableIcons.mockResolvedValue is not a function

      262 |         'cloud', 'support', 'more_horiz'
      263 |     ];
    > 264 |       (activityTypeController.getAvailableIcons as jest.Mock).mockResolvedValue(mockIcons);
          |                                                               ^
      265 |
      266 |       await activityTypeController.getAvailableIcons(
      267 |         mockReq as Request,

      at Object.<anonymous> (controllers/__tests__/activityTypeController.test.ts:264:63)

  ΓùÅ ActivityTypeController ΓÇ║ getAvailableIcons ΓÇ║ should handle errors appropriately

    TypeError: activityTypeController.getAvailableIcons.mockRejectedValue is not a function

      274 |
      275 |     it('should handle errors appropriately', async () => {
    > 276 |       (activityTypeController.getAvailableIcons as jest.Mock).mockRejectedValue(new Error('Failed to fetch icons error'));
          |                                                               ^
      277 |
      278 |       await activityTypeController.getAvailableIcons(
      279 |         mockReq as Request,

      at Object.<anonymous> (controllers/__tests__/activityTypeController.test.ts:276:63)

PASS src/models/__tests__/timeLogModel.test.ts (18.95 s)
  TimeLogModel
    getAllTimeLogs
      ΓêÜ should return all time logs (56 ms)
    createTimeLog
      ΓêÜ should create a time log (6 ms)
    updateTimeLog
      ΓêÜ should update a time log (4 ms)
    deleteTimeLog
      ΓêÜ should delete a time log (5 ms)
    getUserTimeLogs
      ΓêÜ should return user time logs (3 ms)
    getProjectTimeLogs
      ΓêÜ should return project time logs (1 ms)
    getProjectSpentTime
      ΓêÜ should return project spent time (2 ms)
    getTaskTimeLogs
      ΓêÜ should return task time logs (2 ms)
    getTaskSpentTime
      ΓêÜ should return task spent time (2 ms)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\taskController.test.ts:124:59)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      20 |     res.status(200).json(tasks);
      21 |   } catch (error) {
    > 22 |     console.error(error);
         |             ^
      23 |     res.status(500).json({ error: 'Internal server error' });
      24 |   }
      25 | }

      at Object.error [as getTasks] (controllers/taskController.ts:22:13)
      at Object.<anonymous> (controllers/__tests__/taskController.test.ts:126:7)

  console.log
    Created task: {
      task_id: '1',
      name: 'Test Task',
      description: 'Test Description',
      start_date: 2026-01-18T23:41:28.822Z,
      due_date: 2026-01-18T23:41:28.822Z,
      priority_id: 1,
      status_id: 1,
      type_id: 1,
      project_id: 1,
      holder_id: 1,
      assignee_id: 2,
      created_by: 1,
      estimated_time: 2,
      tags: [
        {
          id: 1,
          name: 'Test Tag',
          color: '#000000',
          active: true,
          created_on: 2026-01-18T23:41:28.822Z,
          updated_on: 2026-01-18T23:41:28.822Z
        }
      ]
    }

      at Object.log [as createTask] (controllers/taskController.ts:153:13)

  console.log
    Converted IDs: { taskId: 1, actionUserId: 1, originalId: '1', originalCreatedBy: 1 }

      at Object.log [as createTask] (controllers/taskController.ts:164:13)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\taskController.test.ts:467:61)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      266 |     res.status(200).json(task);
      267 |   } catch (error) {
    > 268 |     console.error(error);
          |             ^
      269 |     res.status(500).json({ error: 'Internal server error' });
      270 |   }
      271 | }

      at Object.error [as deleteTask] (controllers/taskController.ts:268:13)
      at Object.<anonymous> (controllers/__tests__/taskController.test.ts:469:7)

  console.error
    Error creating role: Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\models\__tests__\roleModel.test.ts:44:55)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      21 |     return roleResult.rows[0].id;
      22 |   } catch (error) {
    > 23 |     console.error('Error creating role:', error);
         |             ^
      24 |     throw error;
      25 |   }
      26 | };

      at Object.error [as createRole] (models/roleModel.ts:23:13)
      at Object.<anonymous> (models/__tests__/roleModel.test.ts:46:7)

  console.error
    Error updating role: Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\models\__tests__\roleModel.test.ts:71:55)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      36 |     );
      37 |   } catch (error) {
    > 38 |     console.error('Error updating role:', error);
         |             ^
      39 |     throw error;
      40 |   }
      41 | };

      at Object.error [as updateRole] (models/roleModel.ts:38:13)
      at Object.<anonymous> (models/__tests__/roleModel.test.ts:73:7)

PASS src/models/__tests__/roleModel.test.ts (18.83 s)
  RoleModel
    getRoles
      ΓêÜ should return all roles (92 ms)
    createRole
      ΓêÜ should create a new role (8 ms)
      ΓêÜ should throw error on database failure (314 ms)
    updateRole
      ΓêÜ should update a role (6 ms)
      ΓêÜ should throw error on database failure (9 ms)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\adminController.test.ts:106:63)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      27 |     return true;
      28 |   } catch (error) {
    > 29 |     console.error(error);
         |             ^
      30 |     res.status(500).json({ error: 'Internal server error' });
      31 |     return false;
      32 |   }

      at Object.error [as checkAdminAccess] (controllers/adminController.ts:29:13)
      at Object.<anonymous> (controllers/__tests__/adminController.test.ts:108:22)

FAIL src/controllers/__tests__/taskController.test.ts (19.202 s)
  TaskController
    getTasks
      ΓêÜ should return all tasks when no project_id is provided (42 ms)
      ΓêÜ should return project tasks when project_id is provided (6 ms)
      ΓêÜ should handle errors appropriately (483 ms)
    getTaskById
      ΓêÜ should return a task when it exists (4 ms)
      ΓêÜ should return 404 when task does not exist (3 ms)
    getTaskByAssignee
      ├ù should return tasks for a given assignee (24 ms)
      ΓêÜ should return 404 when no tasks are found (2 ms)
    getTaskByHolder
      ├ù should return tasks for a given holder (11 ms)
      ΓêÜ should return 404 when no tasks are found (2 ms)
    createTask
      ΓêÜ should create a task successfully (16 ms)
      ΓêÜ should return 400 when required fields are missing (5 ms)
    updateTask
      ΓêÜ should update a task successfully (3 ms)
      ΓêÜ should return 404 when task is not found (3 ms)
    changeTaskStatus
      ├ù should change task status successfully (4 ms)
      ├ù should return 404 when task is not found (4 ms)
    deleteTask
      ΓêÜ should delete a task successfully (3 ms)
      ΓêÜ should handle errors appropriately (13 ms)
    getTaskStatuses
      ΓêÜ should return all task statuses (16 ms)
    getPriorities
      ΓêÜ should return all priorities (31 ms)
    getActiveTasks
      ΓêÜ should return active tasks for a user (4 ms)
    getSubtasks
      ΓêÜ should return subtasks for a task (5 ms)
      ΓêÜ should handle case when no subtasks exist (1 ms)

  ΓùÅ TaskController ΓÇ║ getTaskByAssignee ΓÇ║ should return tasks for a given assignee

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    - Expected
    + Received

      {},
      Object {
    -   "assignee_id": "123",
    +   "assignee_id": 123,
      },

    Number of calls: 1

      212 |       );
      213 |
    > 214 |       expect(taskModel.getTasks).toHaveBeenCalledWith(mockPool, { assignee_id: assigneeId });
          |                                  ^
      215 |       expect(mockRes.status).toHaveBeenCalledWith(200);
      216 |       expect(mockRes.json).toHaveBeenCalledWith(mockTasks);
      217 |     });

      at Object.<anonymous> (controllers/__tests__/taskController.test.ts:214:34)

  ΓùÅ TaskController ΓÇ║ getTaskByHolder ΓÇ║ should return tasks for a given holder

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    - Expected
    + Received

      {},
      Object {
    -   "holder_id": "123",
    +   "holder_id": 123,
      },

    Number of calls: 1

      260 |       );
      261 |
    > 262 |       expect(taskModel.getTasks).toHaveBeenCalledWith(mockPool, { holder_id: holderId });
          |                                  ^
      263 |       expect(mockRes.status).toHaveBeenCalledWith(200);
      264 |       expect(mockRes.json).toHaveBeenCalledWith(mockTasks);
      265 |     });

      at Object.<anonymous> (controllers/__tests__/taskController.test.ts:262:34)

  ΓùÅ TaskController ΓÇ║ changeTaskStatus ΓÇ║ should change task status successfully

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: {}, "123", {"status_id": "2"}

    Number of calls: 0

      425 |       );
      426 |
    > 427 |       expect(taskModel.updateTask).toHaveBeenCalledWith(mockPool, taskId, { status_id: newStatusId });
          |                                    ^
      428 |       expect(mockRes.status).toHaveBeenCalledWith(200);
      429 |       expect(mockRes.json).toHaveBeenCalledWith(updatedTask);
      430 |     });

      at Object.<anonymous> (controllers/__tests__/taskController.test.ts:427:36)

  ΓùÅ TaskController ΓÇ║ changeTaskStatus ΓÇ║ should return 404 when task is not found

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    - Expected
    + Received

      Object {
    -   "error": "Task not found",
    +   "error": "Unable to update task status",
      },

    Number of calls: 1

      442 |
      443 |       expect(mockRes.status).toHaveBeenCalledWith(404);
    > 444 |       expect(mockRes.json).toHaveBeenCalledWith({ error: 'Task not found' });
          |                            ^
      445 |     });
      446 |   });
      447 |

      at Object.<anonymous> (controllers/__tests__/taskController.test.ts:444:28)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\adminController.test.ts:142:66)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      43 |     res.status(200).json(stats);
      44 |   } catch (error) {
    > 45 |     console.error(error);
         |             ^
      46 |     res.status(500).json({ error: 'Internal server error' });
      47 |   }
      48 | };

      at Object.error [as getSystemStats] (controllers/adminController.ts:45:13)
      at Object.<anonymous> (controllers/__tests__/adminController.test.ts:144:7)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\adminController.test.ts:207:65)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      59 |     res.status(200).json(logs);
      60 |   } catch (error) {
    > 61 |     console.error(error);
         |             ^
      62 |     res.status(500).json({ error: 'Internal server error' });
      63 |   }
      64 | };

      at Object.error [as getSystemLogs] (controllers/adminController.ts:61:13)
      at Object.<anonymous> (controllers/__tests__/adminController.test.ts:209:7)

  console.error
    Error fetching permissions: Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\adminController.test.ts:240:69)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      74 |     res.status(200).json(permissions);
      75 |   } catch (error) {
    > 76 |     console.error('Error fetching permissions:', error);
         |             ^
      77 |     res.status(500).json({ error: 'Failed to fetch permissions' });
      78 |   }
      79 | };

      at Object.error [as getAllPermissions] (controllers/adminController.ts:76:13)
      at Object.<anonymous> (controllers/__tests__/adminController.test.ts:242:7)

FAIL src/controllers/__tests__/adminController.test.ts (19.569 s)
  AdminController
    checkAdminAccess
      ΓêÜ should return true when user is admin (70 ms)
      ├ù should return 401 when user is not authenticated (14 ms)
      ├ù should return 403 when user is not admin (4 ms)
      ΓêÜ should handle errors appropriately (334 ms)
    getSystemStats
      ΓêÜ should return system stats successfully (4 ms)
      ΓêÜ should handle errors appropriately (9 ms)
    getSystemLogs
      ├ù should return system logs successfully (12 ms)
      ├ù should handle empty query parameters (3 ms)
      ΓêÜ should handle errors appropriately (10 ms)
    getAllPermissions
      ΓêÜ should return all permissions successfully (2 ms)
      ΓêÜ should handle errors appropriately (11 ms)

  ΓùÅ AdminController ΓÇ║ checkAdminAccess ΓÇ║ should return 401 when user is not authenticated

    expect(received).toEqual(expected) // deep equality

    Expected: Any<Object>
    Received: undefined

      86 |       expect(mockRes.status).toHaveBeenCalledWith(401);
      87 |       expect(mockRes.json).toHaveBeenCalledWith({ error: 'User not authenticated' });
    > 88 |       expect(result).toEqual(expect.any(Object));
         |                      ^
      89 |     });
      90 |
      91 |     it('should return 403 when user is not admin', async () => {

      at Object.<anonymous> (controllers/__tests__/adminController.test.ts:88:22)

  ΓùÅ AdminController ΓÇ║ checkAdminAccess ΓÇ║ should return 403 when user is not admin

    expect(received).toEqual(expected) // deep equality

    Expected: Any<Object>
    Received: undefined

      100 |       expect(mockRes.status).toHaveBeenCalledWith(403);
      101 |       expect(mockRes.json).toHaveBeenCalledWith({ error: 'Access denied' });
    > 102 |       expect(result).toEqual(expect.any(Object));
          |                      ^
      103 |     });
      104 |
      105 |     it('should handle errors appropriately', async () => {

      at Object.<anonymous> (controllers/__tests__/adminController.test.ts:102:22)

  ΓùÅ AdminController ΓÇ║ getSystemLogs ΓÇ║ should return system logs successfully

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: [{"activity_name": "login", "activity_type_id": 1, "created_on": 2026-01-18T23:41:29.204Z, "description": "User logged in", "id": 1, "user_id": 1, "user_login": "test"}]
    Received: undefined

    Number of calls: 1

      178 |
      179 |       expect(mockRes.status).toHaveBeenCalledWith(200);
    > 180 |       expect(mockRes.json).toHaveBeenCalledWith(mockLogs);
          |                            ^
      181 |       expect(adminModel.getSystemLogs).toHaveBeenCalledWith(
      182 |         mockPool,
      183 |         mockQuery.startDate,

      at Object.<anonymous> (controllers/__tests__/adminController.test.ts:180:28)

  ΓùÅ AdminController ΓÇ║ getSystemLogs ΓÇ║ should handle empty query parameters

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: [{"activity_name": "login", "activity_type_id": 1, "created_on": 2026-01-18T23:41:29.204Z, "description": "User logged in", "id": 1, "user_id": 1, "user_login": "test"}]
    Received: undefined

    Number of calls: 1

      195 |
      196 |       expect(mockRes.status).toHaveBeenCalledWith(200);
    > 197 |       expect(mockRes.json).toHaveBeenCalledWith(mockLogs);
          |                            ^
      198 |       expect(adminModel.getSystemLogs).toHaveBeenCalledWith(
      199 |         mockPool,
      200 |         undefined,

      at Object.<anonymous> (controllers/__tests__/adminController.test.ts:197:28)

PASS src/models/__tests__/watcherModel.test.ts
  WatcherModel
    getTaskWatchers
      ΓêÜ should return task watchers (7 ms)
    addTaskWatcher
      ΓêÜ should add a task watcher (2 ms)
      ΓêÜ should return null when insert fails (2 ms)
    removeTaskWatcher
      ΓêÜ should remove a task watcher (2 ms)
      ΓêÜ should return 0 when watcher not found (1 ms)

PASS src/models/__tests__/userModel.test.ts
  UserModel
    getUsers
      ΓêÜ should return all users without filters (6 ms)
      ΓêÜ should return filtered users with whereParams (2 ms)
      ΓêÜ should handle multiple filter parameters (3 ms)
    getUserById
      ΓêÜ should return a user by ID (46 ms)
      ΓêÜ should return null when user not found (1 ms)
    createUser
      ΓêÜ should create a new user (2 ms)
    updateUser
      ΓêÜ should update a user (5 ms)
      ΓêÜ should handle password update with encryption (2 ms)
    changeUserStatus
      ΓêÜ should change user status (2 ms)
      ΓêÜ should return null when user not found (2 ms)
    deleteUser
      ΓêÜ should soft delete a user by setting status to 3 (24 ms)
      ΓêÜ should return null when user not found (2 ms)

  console.error
    Error: DB error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\profileController.test.ts:123:64)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      23 |     res.status(200).json(profile);
      24 |   } catch (error) {
    > 25 |     console.error(error);
         |             ^
      26 |     res.status(500).json({
      27 |       error: 'Internal server error'
      28 |     });

      at error (controllers/profileController.ts:25:13)
      at Object.<anonymous> (controllers/__tests__/profileController.test.ts:125:7)

  console.error
    Error: DB error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\profileController.test.ts:297:71)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      145 |     res.status(200).json(projects);
      146 |   } catch (error) {
    > 147 |     console.error(error);
          |             ^
      148 |     res.status(500).json({
      149 |       error: 'Internal server error'
      150 |     });

      at error (controllers/profileController.ts:147:13)
      at Object.<anonymous> (controllers/__tests__/profileController.test.ts:299:7)

PASS src/models/__tests__/taskTypeModel.test.ts
  TaskTypeModel
    getTaskTypes
      ΓêÜ should return all active task types (4 ms)
    getTaskTypeById
      ΓêÜ should return a task type by ID (2 ms)
      ΓêÜ should return null when task type not found (3 ms)
    createTaskType
      ΓêÜ should create a task type (5 ms)
    updateTaskType
      ΓêÜ should update a task type (2 ms)
      ΓêÜ should return null when task type not found (2 ms)
    deleteTaskType
      ΓêÜ should soft delete a task type (3 ms)
      ΓêÜ should return null when task type not found (2 ms)

PASS src/models/__tests__/tagModel.test.ts
  TagModel
    getTags
      ΓêÜ should return all active tags (10 ms)
    createTag
      ΓêÜ should create a tag (2 ms)
    addTaskTags
      ΓêÜ should add tags to a task (4 ms)
    removeTaskTag
      ΓêÜ should remove a tag from a task (2 ms)
    getTaskTags
      ΓêÜ should return tags for a task (1 ms)
    updateTag
      ΓêÜ should update a tag (1 ms)
      ΓêÜ should return null when tag not found (1 ms)
    deleteTag
      ΓêÜ should soft delete a tag (2 ms)

FAIL src/controllers/__tests__/profileController.test.ts (20.027 s)
  Profile Controller
    getProfile
      ΓêÜ should return profile data when authenticated (96 ms)
      ΓêÜ should return 401 when unauthenticated (12 ms)
      ΓêÜ should handle internal server errors (429 ms)
      ├ù should handle case when profile is not found (10 ms)
    updateProfile
      ΓêÜ should update profile with valid data (6 ms)
      ΓêÜ should handle partial updates (17 ms)
      ΓêÜ should return 401 when unauthenticated (3 ms)
      ├ù should handle case when profile update fails (4 ms)
    getRecentTasks
      ΓêÜ should fetch recent tasks (5 ms)
      ΓêÜ should handle empty task list (2 ms)
    getRecentProjects
      ΓêÜ should fetch recent projects (3 ms)
      ΓêÜ should handle database errors (23 ms)
    changePassword
      ├ù should update password with valid input (13 ms)
      ├ù should return 400 with invalid passwords (14 ms)
      ├ù should handle incorrect old password (2 ms)

  ΓùÅ Profile Controller ΓÇ║ getProfile ΓÇ║ should handle case when profile is not found

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: 404
    Received: 200

    Number of calls: 1

      135 |
      136 |       expect(getProfileSpy).toHaveBeenCalledWith(mockPool, '1');
    > 137 |       expect(mockStatus).toHaveBeenCalledWith(404);
          |                          ^
      138 |       expect(mockJson).toHaveBeenCalledWith({ error: 'Profile not found' });
      139 |     });
      140 |   });

      at Object.<anonymous> (controllers/__tests__/profileController.test.ts:137:26)

  ΓùÅ Profile Controller ΓÇ║ updateProfile ΓÇ║ should handle case when profile update fails

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: 404
    Received: 200

    Number of calls: 1

      226 |         expect.objectContaining({ name: 'New Name' })
      227 |       );
    > 228 |       expect(mockStatus).toHaveBeenCalledWith(404);
          |                          ^
      229 |       expect(mockJson).toHaveBeenCalledWith({ error: 'Profile not found' });
      230 |     });
      231 |   });

      at Object.<anonymous> (controllers/__tests__/profileController.test.ts:228:26)

  ΓùÅ Profile Controller ΓÇ║ changePassword ΓÇ║ should update password with valid input

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: {}, "1", "oldPass123", "newPass123"

    Number of calls: 0

      314 |       await changePassword(mockRequest as Request, mockResponse, mockPool);
      315 |
    > 316 |       expect(profileModel.changePassword).toHaveBeenCalledWith(
          |                                           ^
      317 |         mockPool,
      318 |         '1',
      319 |         'oldPass123',

      at Object.<anonymous> (controllers/__tests__/profileController.test.ts:316:43)

  ΓùÅ Profile Controller ΓÇ║ changePassword ΓÇ║ should return 400 with invalid passwords

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    - Expected
    + Received

      Object {
    -   "error": "Invalid password format",
    +   "error": "Current password is incorrect",
      },

    Number of calls: 1

      329 |
      330 |       expect(mockStatus).toHaveBeenCalledWith(400);
    > 331 |       expect(mockJson).toHaveBeenCalledWith({ error: 'Invalid password format' });
          |                        ^
      332 |     });
      333 |
      334 |     it('should handle incorrect old password', async () => {

      at Object.<anonymous> (controllers/__tests__/profileController.test.ts:331:24)

  ΓùÅ Profile Controller ΓÇ║ changePassword ΓÇ║ should handle incorrect old password

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: 401
    Received: 400

    Number of calls: 1

      341 |       await changePassword(mockRequest as Request, mockResponse, mockPool);
      342 |
    > 343 |       expect(mockStatus).toHaveBeenCalledWith(401);
          |                          ^
      344 |       expect(mockJson).toHaveBeenCalledWith({ error: 'Invalid old password' });
      345 |     });
      346 |   });

      at Object.<anonymous> (controllers/__tests__/profileController.test.ts:343:26)

PASS src/models/__tests__/settingsModel.test.ts
  SettingsModel
    getSystemSettings
      ΓêÜ should return system settings (4 ms)
      ΓêÜ should return null when no settings found (1 ms)
    updateSystemSettings
      ΓêÜ should update system settings (2 ms)
    getUserSettings
      ΓêÜ should return user settings (1 ms)
      ΓêÜ should return null when no user settings found (1 ms)
    updateUserSettings
      ΓêÜ should update user settings with upsert (30 ms)

PASS src/models/__tests__/projectModel.test.ts
  ProjectModel
    getProjects
      ΓêÜ should return all projects without filters (6 ms)
      ΓêÜ should return filtered projects with whereParams (3 ms)
    getProjectById
      ΓêÜ should return a project by ID (3 ms)
      ΓêÜ should return null when project not found (38 ms)
    getProjectDetails
      ΓêÜ should return project details (2 ms)
    createProject
      ΓêÜ should create a new project (3 ms)
    changeProjectStatus
      ΓêÜ should change project status (2 ms)
    updateProject
      ΓêÜ should update a project (2 ms)
    deleteProject
      ΓêÜ should delete a project (1 ms)
    getProjectMembers
      ΓêÜ should return project members (1 ms)
    getSubprojects
      ΓêÜ should return subprojects (26 ms)
    addProjectMember
      ΓêÜ should add a project member (2 ms)
    deleteProjectMember
      ΓêÜ should delete a project member (1 ms)
    getProjectTasks
      ΓêÜ should return project tasks (2 ms)
    getProjectStatuses
      ΓêÜ should return project statuses (1 ms)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\projectController.test.ts:102:65)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      26 |     res.status(200).json(projects);
      27 |   } catch (error) {
    > 28 |     console.error(error);
         |             ^
      29 |     res.status(500).json({ error: 'Internal server error' });
      30 |   }
      31 | };

      at Object.error [as getProjects] (controllers/projectController.ts:28:13)
      at Object.<anonymous> (controllers/__tests__/projectController.test.ts:104:7)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\projectController.test.ts:148:68)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      46 |     res.status(200).json(project);
      47 |   } catch (error) {
    > 48 |     console.error(error);
         |             ^
      49 |     res.status(500).json({ error: 'Internal server error' });
      50 |   }
      51 | };

      at Object.error [as getProjectById] (controllers/projectController.ts:48:13)
      at Object.<anonymous> (controllers/__tests__/projectController.test.ts:150:7)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\projectController.test.ts:194:71)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      66 |     res.status(200).json(project);
      67 |   } catch (error) {
    > 68 |     console.error(error);
         |             ^
      69 |     res.status(500).json({ error: 'Internal server error' });
      70 |   }
      71 | };

      at Object.error [as getProjectDetails] (controllers/projectController.ts:68:13)
      at Object.<anonymous> (controllers/__tests__/projectController.test.ts:196:7)

  console.error
    Error creating project: Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\projectController.test.ts:247:67)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      105 |     res.status(201).json(project);
      106 |   } catch (error) {
    > 107 |     console.error('Error creating project:', error);
          |             ^
      108 |     res.status(500).json({ error: 'Internal server error' });
      109 |   }
      110 | };

      at Object.error [as createProject] (controllers/projectController.ts:107:13)
      at Object.<anonymous> (controllers/__tests__/projectController.test.ts:249:7)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\projectController.test.ts:296:73)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      126 |     res.status(200).json(result);
      127 |   } catch (error) {
    > 128 |     console.error(error);
          |             ^
      129 |     res.status(500).json({ error: 'Internal server error' });
      130 |   }
      131 | };

      at Object.error [as changeProjectStatus] (controllers/projectController.ts:128:13)
      at Object.<anonymous> (controllers/__tests__/projectController.test.ts:298:7)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\projectController.test.ts:346:67)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      150 |     res.status(200).json(result);
      151 |   } catch (error) {
    > 152 |     console.error(error);
          |             ^
      153 |     res.status(500).json({ error: 'Internal server error' });
      154 |   }
      155 | };

      at Object.error [as updateProject] (controllers/projectController.ts:152:13)
      at Object.<anonymous> (controllers/__tests__/projectController.test.ts:348:7)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\projectController.test.ts:391:67)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      170 |     res.status(200).json(result);
      171 |   } catch (error) {
    > 172 |     console.error(error);
          |             ^
      173 |     res.status(500).json({ error: 'Internal server error' });
      174 |   }
      175 | };

      at Object.error [as deleteProject] (controllers/projectController.ts:172:13)
      at Object.<anonymous> (controllers/__tests__/projectController.test.ts:393:7)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\projectController.test.ts:426:71)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      186 |     res.status(200).json(members);
      187 |   } catch (error) {
    > 188 |     console.error(error);
          |             ^
      189 |     res.status(500).json({ error: 'Internal server error' });
      190 |   }
      191 | };

      at Object.error [as getProjectMembers] (controllers/projectController.ts:188:13)
      at Object.<anonymous> (controllers/__tests__/projectController.test.ts:428:7)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\projectController.test.ts:477:70)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      213 |     res.status(201).json(result);
      214 |   } catch (error) {
    > 215 |     console.error(error);
          |             ^
      216 |     res.status(500).json({ error: 'Internal server error' });
      217 |   }
      218 | };

      at Object.error [as addProjectMember] (controllers/projectController.ts:215:13)
      at Object.<anonymous> (controllers/__tests__/projectController.test.ts:479:7)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\projectController.test.ts:526:73)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      234 |     res.status(200).json(result);
      235 |   } catch (error) {
    > 236 |     console.error(error);
          |             ^
      237 |     res.status(500).json({ error: 'Internal server error' });
      238 |   }
      239 | };

      at Object.error [as deleteProjectMember] (controllers/projectController.ts:236:13)
      at Object.<anonymous> (controllers/__tests__/projectController.test.ts:528:7)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\projectController.test.ts:560:68)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      250 |     res.status(200).json(subprojects);
      251 |   } catch (error) {
    > 252 |     console.error(error);
          |             ^
      253 |     res.status(500).json({ error: 'Internal server error' });
      254 |   }
      255 | };

      at Object.error [as getSubprojects] (controllers/projectController.ts:252:13)
      at Object.<anonymous> (controllers/__tests__/projectController.test.ts:562:7)

  console.error
    Error fetching project tasks: Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\projectController.test.ts:615:69)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      273 |     res.status(200).json(tasks);
      274 |   } catch (error) {
    > 275 |     console.error('Error fetching project tasks:', error);
          |             ^
      276 |     res.status(500).json({ error: 'Internal server error' });
      277 |   }
      278 | };

      at Object.error [as getProjectTasks] (controllers/projectController.ts:275:13)
      at Object.<anonymous> (controllers/__tests__/projectController.test.ts:617:7)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\projectController.test.ts:648:72)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      288 |     res.status(200).json(statuses);
      289 |   } catch (error) {
    > 290 |     console.error(error);
          |             ^
      291 |     res.status(500).json({ error: 'Internal server error' });
      292 |   }
      293 | };

      at Object.error [as getProjectStatuses] (controllers/projectController.ts:290:13)
      at Object.<anonymous> (controllers/__tests__/projectController.test.ts:650:7)

PASS src/controllers/__tests__/projectController.test.ts
  ProjectController
    getProjects
      ΓêÜ should return all projects (4 ms)
      ΓêÜ should return empty array when no projects found (3 ms)
      ΓêÜ should handle errors (100 ms)
    getProjectById
      ΓêÜ should return a project when found (3 ms)
      ΓêÜ should return 404 when project not found (3 ms)
      ΓêÜ should handle errors (10 ms)
    getProjectDetails
      ΓêÜ should return project details when found (3 ms)
      ΓêÜ should return 404 when project not found (3 ms)
      ΓêÜ should handle errors (8 ms)
    createProject
      ΓêÜ should create a project successfully (11 ms)
      ΓêÜ should return 401 when user not authenticated (2 ms)
      ΓêÜ should handle errors (11 ms)
    changeProjectStatus
      ΓêÜ should change project status successfully (4 ms)
      ΓêÜ should return 404 when project not found (2 ms)
      ΓêÜ should handle errors (9 ms)
    updateProject
      ΓêÜ should update a project successfully (3 ms)
      ΓêÜ should return 404 when project not found (2 ms)
      ΓêÜ should handle errors (7 ms)
    deleteProject
      ΓêÜ should delete a project successfully (3 ms)
      ΓêÜ should return 404 when project not found (2 ms)
      ΓêÜ should handle errors (8 ms)
    getProjectMembers
      ΓêÜ should return project members (2 ms)
      ΓêÜ should handle errors (8 ms)
    addProjectMember
      ΓêÜ should add a project member successfully (6 ms)
      ΓêÜ should return 404 when project or user not found (2 ms)
      ΓêÜ should handle errors (6 ms)
    deleteProjectMember
      ΓêÜ should delete a project member successfully (4 ms)
      ΓêÜ should return 404 when project member not found (2 ms)
      ΓêÜ should handle errors (10 ms)
    getSubprojects
      ΓêÜ should return subprojects (3 ms)
      ΓêÜ should handle errors (8 ms)
    getProjectTasks
      ΓêÜ should return project tasks (2 ms)
      ΓêÜ should pass filters to model (2 ms)
      ΓêÜ should handle errors (6 ms)
    getProjectStatuses
      ΓêÜ should return project statuses (3 ms)
      ΓêÜ should handle errors (14 ms)

PASS src/models/__tests__/loginModel.test.ts
  LoginModel
    login
      ΓêÜ should return user data on successful authentication (6 ms)
      ΓêÜ should return null when authentication fails (1 ms)
      ΓêÜ should throw error on database failure (15 ms)
    app_logins
      ΓêÜ should insert a login record (2 ms)
      ΓêÜ should throw error on database failure (13 ms)

PASS src/models/__tests__/permissionModel.test.ts
  PermissionModel
    getUserPermissions
      ΓêÜ should return user permissions (10 ms)
      ΓêÜ should return empty array when user has no permissions (1 ms)
    hasPermission
      ΓêÜ should return true when user has permission (3 ms)
      ΓêÜ should return false when user does not have permission (2 ms)
      ΓêÜ should handle database errors (32 ms)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\userController.test.ts:106:59)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      18 |     res.status(200).json(users);
      19 |   } catch (error) {
    > 20 |     console.error(error);
         |             ^
      21 |     res.status(500).json({ error: 'Internal server error' });
      22 |   }
      23 | };

      at Object.error [as getUsers] (controllers/userController.ts:20:13)
      at Object.<anonymous> (controllers/__tests__/userController.test.ts:108:7)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\userController.test.ts:152:62)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      37 |     res.status(200).json(user);
      38 |   } catch (error) {
    > 39 |     console.error(error);
         |             ^
      40 |     res.status(500).json({ error: 'Internal server error' });
      41 |   }
      42 | };

      at Object.error [as getUserById] (controllers/userController.ts:39:13)
      at Object.<anonymous> (controllers/__tests__/userController.test.ts:154:7)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\userController.test.ts:200:61)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      68 |     res.status(201).json(user);
      69 |   } catch (error) {
    > 70 |     console.error(error);
         |             ^
      71 |     res.status(500).json({ error: 'Internal server error' });
      72 |   }
      73 | };

      at Object.error [as createUser] (controllers/userController.ts:70:13)
      at Object.<anonymous> (controllers/__tests__/userController.test.ts:202:7)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\userController.test.ts:250:61)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      88 |     res.status(200).json(user);
      89 |   } catch (error) {
    > 90 |     console.error(error);
         |             ^
      91 |     res.status(500).json({ error: 'Internal server error' });
      92 |   }
      93 | };

      at Object.error [as updateUser] (controllers/userController.ts:90:13)
      at Object.<anonymous> (controllers/__tests__/userController.test.ts:252:7)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\userController.test.ts:299:67)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      108 |     res.status(200).json(user);
      109 |   } catch (error) {
    > 110 |     console.error(error);
          |             ^
      111 |     res.status(500).json({ error: 'Internal server error' });
      112 |   }
      113 | };

      at Object.error [as changeUserStatus] (controllers/userController.ts:110:13)
      at Object.<anonymous> (controllers/__tests__/userController.test.ts:301:7)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\userController.test.ts:344:61)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      127 |     res.status(200).json({ message: 'User deleted' });
      128 |   } catch (error) {
    > 129 |     console.error(error);
          |             ^
      130 |     res.status(500).json({ error: 'Internal server error' });
      131 |   }
      132 | };

      at Object.error [as deleteUser] (controllers/userController.ts:129:13)
      at Object.<anonymous> (controllers/__tests__/userController.test.ts:346:7)

  console.error
    Failed to fetch permissions: Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\userController.test.ts:386:75)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      147 |     res.json(permissions);
      148 |   } catch (error) {
    > 149 |     console.error('Failed to fetch permissions:', error);
          |             ^
      150 |     res.status(500).json({ error: 'Internal server error' });
      151 |   }
      152 | };

      at Object.error [as getUserPermissions] (controllers/userController.ts:149:13)
      at Object.<anonymous> (controllers/__tests__/userController.test.ts:388:7)

  console.error
    Error in getTaskFiles: Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\fileController.test.ts:100:21)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      19 |     res.status(200).json(files);
      20 |   } catch (error) {
    > 21 |     console.error('Error in getTaskFiles:', error);
         |             ^
      22 |     res.status(500).json({ error: 'Internal server error' });
      23 |   }
      24 | };

      at error (controllers/fileController.ts:21:13)
      at Object.<anonymous> (controllers/__tests__/fileController.test.ts:103:7)

  console.error
    Error in uploadFile: Error: Upload error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\fileController.test.ts:185:21)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      63 |     res.status(201).json(fileData);
      64 |   } catch (error) {
    > 65 |     console.error('Error in uploadFile:', error);
         |             ^
      66 |     res.status(500).json({ error: 'Internal server error' });
      67 |   }
      68 | };

      at error (controllers/fileController.ts:65:13)
      at Object.<anonymous> (controllers/__tests__/fileController.test.ts:188:7)

  console.error
    Error in downloadFile: Error: Download error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\fileController.test.ts:246:62)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

       95 |     }
       96 |   } catch (error) {
    >  97 |     console.error('Error in downloadFile:', error);
          |             ^
       98 |     res.status(500).json({ error: 'Internal server error' });
       99 |   }
      100 | };

      at error (controllers/fileController.ts:97:13)
      at Object.<anonymous> (controllers/__tests__/fileController.test.ts:248:7)

PASS src/controllers/__tests__/userController.test.ts
  UserController
    getUsers
      ΓêÜ should return all users (5 ms)
      ΓêÜ should return users with whereParams filter (3 ms)
      ΓêÜ should handle errors (104 ms)
    getUserById
      ΓêÜ should return a user when found (6 ms)
      ΓêÜ should return 404 when user not found (51 ms)
      ΓêÜ should handle errors (16 ms)
    createUser
      ΓêÜ should create a user successfully (3 ms)
      ΓêÜ should handle errors (67 ms)
    updateUser
      ΓêÜ should update a user successfully (3 ms)
      ΓêÜ should return 404 when user not found (2 ms)
      ΓêÜ should handle errors (12 ms)
    changeUserStatus
      ΓêÜ should change user status successfully (2 ms)
      ΓêÜ should return 404 when user not found (71 ms)
      ΓêÜ should handle errors (11 ms)
    deleteUser
      ΓêÜ should delete a user successfully (3 ms)
      ΓêÜ should return 404 when user not found (2 ms)
      ΓêÜ should handle errors (58 ms)
    getUserPermissions
      ΓêÜ should return user permissions (6 ms)
      ΓêÜ should return 401 when not authenticated (2 ms)
      ΓêÜ should handle errors (5 ms)

  console.error
    Error in deleteFile: Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\fileController.test.ts:303:61)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      126 |     res.status(200).json({ message: 'File deleted successfully' });
      127 |   } catch (error) {
    > 128 |     console.error('Error in deleteFile:', error);
          |             ^
      129 |     res.status(500).json({ error: 'Internal server error' });
      130 |   }
      131 | };

      at error (controllers/fileController.ts:128:13)
      at Object.<anonymous> (controllers/__tests__/fileController.test.ts:305:7)

  console.error
    Error: DB error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\watcherController.test.ts:32:69)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      14 |     res.status(200).json(watchers);
      15 |   } catch (error) {
    > 16 |     console.error(error);
         |             ^
      17 |     res.status(500).json({ error: 'Internal server error' });
      18 |   }
      19 | }

      at Object.error [as getTaskWatchers] (controllers/watcherController.ts:16:13)
      at Object.<anonymous> (controllers/__tests__/watcherController.test.ts:33:7)

  console.error
    Error deleting file from disk: Error: File not found
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\fileController.test.ts:314:50)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      120 |       await fs.unlink(filePath);
      121 |     } catch (error) {
    > 122 |       console.error('Error deleting file from disk:', error);
          |               ^
      123 |       // Continue even if file doesn't exist on disk
      124 |     }
      125 |

      at error (controllers/fileController.ts:122:15)
      at Object.<anonymous> (controllers/__tests__/fileController.test.ts:316:7)

  console.error
    Error: DB error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\watcherController.test.ts:52:68)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      31 |     res.status(201).json(watcher);
      32 |   } catch (error) {
    > 33 |     console.error(error);
         |             ^
      34 |     res.status(500).json({ error: 'Internal server error' });
      35 |   }
      36 | }

      at Object.error [as addTaskWatcher] (controllers/watcherController.ts:33:13)
      at Object.<anonymous> (controllers/__tests__/watcherController.test.ts:53:7)

PASS src/controllers/__tests__/fileController.test.ts
  fileController
    getTaskFiles
      ΓêÜ should return files successfully (9 ms)
      ΓêÜ should handle errors (374 ms)
    uploadFile
      ΓêÜ should upload file successfully (3 ms)
      ΓêÜ should handle unauthorized user (2 ms)
      ΓêÜ should handle missing file (3 ms)
      ΓêÜ should handle invalid task ID (3 ms)
      ΓêÜ should handle upload errors (50 ms)
    downloadFile
      ΓêÜ should download file successfully (2 ms)
      ΓêÜ should handle file not found in database (2 ms)
      ΓêÜ should handle file not found on disk (2 ms)
      ΓêÜ should handle download errors (6 ms)
    deleteFile
      ΓêÜ should delete file successfully (2 ms)
      ΓêÜ should handle file not found (48 ms)
      ΓêÜ should handle database deletion error (8 ms)
      ΓêÜ should succeed even if file does not exist on disk (10 ms)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\timeLogController.test.ts:87:68)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      15 |     res.status(200).json(timeLogs);
      16 |   } catch (error) {
    > 17 |     console.error(error);
         |             ^
      18 |     res.status(500).json({ error: 'Internal server error' });
      19 |   }
      20 | };

      at Object.error [as getAllTimeLogs] (controllers/timeLogController.ts:17:13)
      at Object.<anonymous> (controllers/__tests__/timeLogController.test.ts:89:7)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\timeLogController.test.ts:119:69)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      31 |     res.status(200).json(timeLogs);
      32 |   } catch (error) {
    > 33 |     console.error(error);
         |             ^
      34 |     res.status(500).json({ error: 'Internal server error' });
      35 |   }
      36 | };

      at Object.error [as getTaskTimeLogs] (controllers/timeLogController.ts:33:13)
      at Object.<anonymous> (controllers/__tests__/timeLogController.test.ts:121:7)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\timeLogController.test.ts:151:70)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      47 |     res.status(200).json(spentTime);
      48 |   } catch (error) {
    > 49 |     console.error(error);
         |             ^
      50 |     res.status(500).json({ error: 'Internal server error' });
      51 |   }
      52 | };

      at Object.error [as getTaskSpentTime] (controllers/timeLogController.ts:49:13)
      at Object.<anonymous> (controllers/__tests__/timeLogController.test.ts:153:7)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\timeLogController.test.ts:183:72)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      64 |     res.status(200).json(timeLogs);
      65 |   } catch (error) {
    > 66 |     console.error(error);
         |             ^
      67 |     res.status(500).json({ error: 'Internal server error' });
      68 |   }
      69 | };

      at Object.error [as getProjectTimeLogs] (controllers/timeLogController.ts:66:13)
      at Object.<anonymous> (controllers/__tests__/timeLogController.test.ts:185:7)

  console.error
    Error: DB error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\watcherController.test.ts:77:71)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      51 |     res.status(204).send();
      52 |   } catch (error) {
    > 53 |     console.error(error);
         |             ^
      54 |     res.status(500).json({ error: 'Internal server error' });
      55 |   }
      56 | }

      at Object.error [as removeTaskWatcher] (controllers/watcherController.ts:53:13)
      at Object.<anonymous> (controllers/__tests__/watcherController.test.ts:78:7)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\timeLogController.test.ts:215:73)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      80 |     res.status(200).json(spentTime);
      81 |   } catch (error) {
    > 82 |     console.error(error);
         |             ^
      83 |     res.status(500).json({ error: 'Internal server error' });
      84 |   }
      85 | };

      at Object.error [as getProjectSpentTime] (controllers/timeLogController.ts:82:13)
      at Object.<anonymous> (controllers/__tests__/timeLogController.test.ts:217:7)

PASS src/controllers/__tests__/watcherController.test.ts
  WatcherController
    getTaskWatchers
      ΓêÜ should return task watchers (3 ms)
      ΓêÜ should handle errors (30 ms)
    addTaskWatcher
      ΓêÜ should add a task watcher (2 ms)
      ΓêÜ should handle errors (6 ms)
    removeTaskWatcher
      ΓêÜ should remove a task watcher successfully (5 ms)
      ΓêÜ should return 404 when watcher not found (2 ms)
      ΓêÜ should handle errors (40 ms)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\timeLogController.test.ts:284:67)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      117 |     res.status(201).json(timeLog);
      118 |   } catch (error) {
    > 119 |     console.error(error);
          |             ^
      120 |     res.status(500).json({ error: 'Internal server error' });
      121 |   }
      122 | };

      at Object.error [as createTimeLog] (controllers/timeLogController.ts:119:13)
      at Object.<anonymous> (controllers/__tests__/timeLogController.test.ts:286:7)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\timeLogController.test.ts:324:67)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      145 |     res.status(200).json(timeLog);
      146 |   } catch (error) {
    > 147 |     console.error(error);
          |             ^
      148 |     res.status(500).json({ error: 'Internal server error' });
      149 |   }
      150 | };

      at Object.error [as updateTimeLog] (controllers/timeLogController.ts:147:13)
      at Object.<anonymous> (controllers/__tests__/timeLogController.test.ts:326:7)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\timeLogController.test.ts:355:67)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      161 |     res.status(200).json({ message: 'Time log deleted successfully' });
      162 |   } catch (error) {
    > 163 |     console.error(error);
          |             ^
      164 |     res.status(500).json({ error: 'Internal server error' });
      165 |   }
      166 | };

      at Object.error [as deleteTimeLog] (controllers/timeLogController.ts:163:13)
      at Object.<anonymous> (controllers/__tests__/timeLogController.test.ts:357:7)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\timeLogController.test.ts:398:69)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      183 |     res.status(200).json(timeLogs);
      184 |   } catch (error) {
    > 185 |     console.error(error);
          |             ^
      186 |     res.status(500).json({ error: 'Internal server error' });
      187 |   }
      188 | };

      at Object.error [as getUserTimeLogs] (controllers/timeLogController.ts:185:13)
      at Object.<anonymous> (controllers/__tests__/timeLogController.test.ts:400:7)

PASS src/controllers/__tests__/timeLogController.test.ts
  TimeLogController
    getAllTimeLogs
      ΓêÜ should return all time logs (6 ms)
      ΓêÜ should handle errors (782 ms)
    getTaskTimeLogs
      ΓêÜ should return time logs for a task (3 ms)
      ΓêÜ should handle errors (9 ms)
    getTaskSpentTime
      ΓêÜ should return task spent time (3 ms)
      ΓêÜ should handle errors (6 ms)
    getProjectTimeLogs
      ΓêÜ should return project time logs (3 ms)
      ΓêÜ should handle errors (7 ms)
    getProjectSpentTime
      ΓêÜ should return project spent time (8 ms)
      ΓêÜ should handle errors (7 ms)
    createTimeLog
      ΓêÜ should create a time log successfully (3 ms)
      ΓêÜ should return 401 when user not authenticated (2 ms)
      ΓêÜ should return 400 when required fields missing (2 ms)
      ΓêÜ should handle errors (8 ms)
    updateTimeLog
      ΓêÜ should update a time log successfully (3 ms)
      ΓêÜ should handle errors (5 ms)
    deleteTimeLog
      ΓêÜ should delete a time log successfully (3 ms)
      ΓêÜ should handle errors (7 ms)
    getUserTimeLogs
      ΓêÜ should return user time logs (3 ms)
      ΓêÜ should return 401 when user not authenticated (8 ms)
      ΓêÜ should handle errors (38 ms)

  console.error
    Error getting roles: Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\roleController.test.ts:48:59)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      14 |     res.status(200).json(roles);
      15 |   } catch (error) {
    > 16 |     console.error('Error getting roles:', error);
         |             ^
      17 |     res.status(500).json({ error: 'Failed to get roles' });
      18 |   }
      19 | };

      at Object.error [as getRoles] (controllers/roleController.ts:16:13)
      at Object.<anonymous> (controllers/__tests__/roleController.test.ts:50:7)

  console.error
    Error creating role: Error: Unique constraint violation
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\roleController.test.ts:95:30)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12) {
      code: '23505'
    }

      37 |     });
      38 |   } catch (error) {
    > 39 |     console.error('Error creating role:', error);
         |             ^
      40 |     if (error instanceof Error && 'code' in error && error.code === '23505') { // Unique violation
      41 |       return res.status(409).json({
      42 |         error: 'Role with this name already exists'

      at Object.error [as createRole] (controllers/roleController.ts:39:13)
      at Object.<anonymous> (controllers/__tests__/roleController.test.ts:100:7)

  console.error
    Error creating role: Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\roleController.test.ts:112:61)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      37 |     });
      38 |   } catch (error) {
    > 39 |     console.error('Error creating role:', error);
         |             ^
      40 |     if (error instanceof Error && 'code' in error && error.code === '23505') { // Unique violation
      41 |       return res.status(409).json({
      42 |         error: 'Role with this name already exists'

      at Object.error [as createRole] (controllers/roleController.ts:39:13)
      at Object.<anonymous> (controllers/__tests__/roleController.test.ts:114:7)

  console.error
    Error updating role: Error: Unique constraint violation
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\roleController.test.ts:175:30)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12) {
      code: '23505'
    }

      72 |     });
      73 |   } catch (error) {
    > 74 |     console.error('Error updating role:', error);
         |             ^
      75 |     if (error instanceof Error && 'code' in error) {
      76 |       if (error.code === '23505') {
      77 |         return res.status(409).json({

      at Object.error [as updateRole] (controllers/roleController.ts:74:13)
      at Object.<anonymous> (controllers/__tests__/roleController.test.ts:181:7)

  console.error
    Error updating role: Error: Not found
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\roleController.test.ts:192:29)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12) {
      code: '404'
    }

      72 |     });
      73 |   } catch (error) {
    > 74 |     console.error('Error updating role:', error);
         |             ^
      75 |     if (error instanceof Error && 'code' in error) {
      76 |       if (error.code === '23505') {
      77 |         return res.status(409).json({

      at Object.error [as updateRole] (controllers/roleController.ts:74:13)
      at Object.<anonymous> (controllers/__tests__/roleController.test.ts:198:7)

  console.error
    Error updating role: Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\roleController.test.ts:211:61)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      72 |     });
      73 |   } catch (error) {
    > 74 |     console.error('Error updating role:', error);
         |             ^
      75 |     if (error instanceof Error && 'code' in error) {
      76 |       if (error.code === '23505') {
      77 |         return res.status(409).json({

      at Object.error [as updateRole] (controllers/roleController.ts:74:13)
      at Object.<anonymous> (controllers/__tests__/roleController.test.ts:213:7)

PASS src/controllers/__tests__/roleController.test.ts
  RoleController
    getRoles
      ΓêÜ should return all roles (4 ms)
      ΓêÜ should handle errors (54 ms)
    createRole
      ΓêÜ should create a role successfully (3 ms)
      ΓêÜ should return 400 when name is missing (2 ms)
      ΓêÜ should return 409 for duplicate role name (9 ms)
      ΓêÜ should handle other errors (10 ms)
    updateRole
      ΓêÜ should update a role successfully (3 ms)
      ΓêÜ should return 400 when ID is missing (1 ms)
      ΓêÜ should return 400 when name is missing (2 ms)
      ΓêÜ should return 409 for duplicate role name (8 ms)
      ΓêÜ should return 404 when role not found (6 ms)
      ΓêÜ should handle other errors (7 ms)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\commentController.test.ts:90:21)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      18 |     res.status(200).json(comments);
      19 |   } catch (error) {
    > 20 |     console.error(error);
         |             ^
      21 |     res.status(500).json({ error: 'Internal server error' });
      22 |   }
      23 | };

      at error (controllers/commentController.ts:20:13)
      at Object.<anonymous> (controllers/__tests__/commentController.test.ts:93:7)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\commentController.test.ts:215:21)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      54 |     res.status(201).json(newComment);
      55 |   } catch (error) {
    > 56 |     console.error(error);
         |             ^
      57 |     res.status(500).json({ error: 'Internal server error' });
      58 |   }
      59 | };

      at error (controllers/commentController.ts:56:13)
      at Object.<anonymous> (controllers/__tests__/commentController.test.ts:218:7)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\commentController.test.ts:269:21)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      72 |     res.status(200).json(editedComment);
      73 |   } catch (error) {
    > 74 |     console.error(error);
         |             ^
      75 |     res.status(500).json({ error: 'Internal server error' });
      76 |   }
      77 | };

      at error (controllers/commentController.ts:74:13)
      at Object.<anonymous> (controllers/__tests__/commentController.test.ts:272:7)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\commentController.test.ts:317:21)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      89 |     res.status(200).json(deletedComment);
      90 |   } catch (error) {
    > 91 |     console.error(error);
         |             ^
      92 |     res.status(500).json({ error: 'Internal server error' });
      93 |   }
      94 | };

      at error (controllers/commentController.ts:91:13)
      at Object.<anonymous> (controllers/__tests__/commentController.test.ts:320:7)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\notificationController.test.ts:119:21)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      14 |     res.status(200).json(notifications);
      15 |   } catch (error) {
    > 16 |     console.error(error);
         |             ^
      17 |     res.status(500).json({ error: 'Internal server error' });
      18 |   }
      19 | };

      at error (controllers/notificationController.ts:16:13)
      at Object.<anonymous> (controllers/__tests__/notificationController.test.ts:122:7)

PASS src/controllers/__tests__/commentController.test.ts
  Comment Controller
    getTaskComments
      ΓêÜ should return comments successfully (20 ms)
      ΓêÜ should handle errors (339 ms)
    createComment
      ΓêÜ should create comment successfully (6 ms)
      ΓêÜ should return 401 when user is not authenticated (3 ms)
      ΓêÜ should handle errors (45 ms)
    editComment
      ΓêÜ should edit comment successfully (4 ms)
      ΓêÜ should handle errors (9 ms)
    deleteComment
      ΓêÜ should delete comment successfully (20 ms)
      ΓêÜ should handle errors (8 ms)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\notificationController.test.ts:158:21)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      30 |     res.status(200).json(updatedNotifications);
      31 |   } catch (error) {
    > 32 |     console.error(error);
         |             ^
      33 |     res.status(500).json({ error: 'Internal server error' });
      34 |   }
      35 | };

      at error (controllers/notificationController.ts:32:13)
      at Object.<anonymous> (controllers/__tests__/notificationController.test.ts:161:7)

  console.error
    Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\notificationController.test.ts:182:21)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      46 |     res.status(200).json({ message: 'Notification deleted' });
      47 |   } catch (error) {
    > 48 |     console.error(error);
         |             ^
      49 |     res.status(500).json({ error: 'Internal server error' });
      50 |   }
      51 | };

      at error (controllers/notificationController.ts:48:13)
      at Object.<anonymous> (controllers/__tests__/notificationController.test.ts:185:7)

  console.error
    Error: DB error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\tagController.test.ts:38:57)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      15 |     res.status(200).json(tags);
      16 |   } catch (error) {
    > 17 |     console.error(error);
         |             ^
      18 |     res.status(500).json({ error: 'Internal server error' });
      19 |   }
      20 | };

      at Object.error [as getTags] (controllers/tagController.ts:17:13)
      at Object.<anonymous> (controllers/__tests__/tagController.test.ts:39:7)

  console.error
    Error: DB error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\tagController.test.ts:63:59)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      37 |     res.status(201).json(tag);
      38 |   } catch (error) {
    > 39 |     console.error(error);
         |             ^
      40 |     res.status(500).json({ error: 'Internal server error' });
      41 |   }
      42 | };

      at Object.error [as createTag] (controllers/tagController.ts:39:13)
      at Object.<anonymous> (controllers/__tests__/tagController.test.ts:64:7)

PASS src/controllers/__tests__/notificationController.test.ts
  Notification Controller
    getUserNotifications
      ΓêÜ should get user notifications successfully (29 ms)
      ΓêÜ should handle errors when getting notifications (68 ms)
    markAsRead
      ΓêÜ should mark notifications as read successfully (3 ms)
      ΓêÜ should handle errors when marking notifications as read (6 ms)
    deleteNotification
      ΓêÜ should delete notification successfully (2 ms)
      ΓêÜ should handle errors when deleting notification (7 ms)

PASS src/controllers/__tests__/tagController.test.ts
  TagController
    getTags
      ΓêÜ should return all tags (5 ms)
      ΓêÜ should handle errors (57 ms)
    createTag
      ΓêÜ should create a tag successfully (2 ms)
      ΓêÜ should return 401 when not authenticated (1 ms)
      ΓêÜ should handle errors (5 ms)
    addTaskTags
      ΓêÜ should add tags to task (2 ms)
      ΓêÜ should return 401 when not authenticated (2 ms)
    removeTaskTag
      ΓêÜ should remove tag from task (3 ms)
    getTaskTags
      ΓêÜ should return task tags (3 ms)
    updateTag
      ΓêÜ should update a tag (37 ms)
    deleteTag
      ΓêÜ should delete a tag (2 ms)

  console.log
    Login attempt started

      at Object.log [as login] (controllers/loginController.ts:12:11)

  console.log
    Authenticating user: testuser

      at Object.log [as login] (controllers/loginController.ts:16:13)

  console.log
    User authenticated successfully: testuser

      at Object.log [as login] (controllers/loginController.ts:31:13)

  console.log
    Login logged to app_logins for user: testuser

      at Object.log [as login] (controllers/loginController.ts:42:13)

  console.log
    Login attempt started

      at Object.log [as login] (controllers/loginController.ts:12:11)

  console.log
    Authenticating user: testuser

      at Object.log [as login] (controllers/loginController.ts:16:13)

  console.error
    Invalid username or password for user: testuser

      23 |
      24 |     if (!user) {
    > 25 |       console.error('Invalid username or password for user:', login);
         |               ^
      26 |       return res.status(401).json({
      27 |         error: 'Invalid username or password'
      28 |       });

      at Object.error (controllers/loginController.ts:25:15)
      at Object.<anonymous> (controllers/__tests__/loginController.test.ts:95:7)

  console.log
    Login attempt started

      at Object.log [as login] (controllers/loginController.ts:12:11)

  console.log
    Authenticating user: testuser

      at Object.log [as login] (controllers/loginController.ts:16:13)

  console.error
    Error: DB error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\settingsController.test.ts:38:72)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      15 |     res.status(200).json(settings);
      16 |   } catch (error) {
    > 17 |     console.error(error);
         |             ^
      18 |     res.status(500).json({ error: 'Internal server error' });
      19 |   }
      20 | };

      at Object.error [as getSystemSettings] (controllers/settingsController.ts:17:13)
      at Object.<anonymous> (controllers/__tests__/settingsController.test.ts:39:7)

  console.error
    Login error: Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\loginController.test.ts:110:57)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      48 |     });
      49 |   } catch (error) {
    > 50 |     console.error('Login error:', error);
         |             ^
      51 |     res.status(500).json({
      52 |       error: 'Internal server error'
      53 |     });

      at Object.error (controllers/loginController.ts:50:13)
      at Object.<anonymous> (controllers/__tests__/loginController.test.ts:112:7)

  console.error
    Error: DB error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\settingsController.test.ts:55:75)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      30 |     res.status(200).json(settings);
      31 |   } catch (error) {
    > 32 |     console.error(error);
         |             ^
      33 |     res.status(500).json({ error: 'Internal server error' });
      34 |   }
      35 | };

      at Object.error [as updateSystemSettings] (controllers/settingsController.ts:32:13)
      at Object.<anonymous> (controllers/__tests__/settingsController.test.ts:56:7)

PASS src/controllers/__tests__/loginController.test.ts
  LoginController
    login
      ΓêÜ should login successfully with valid credentials (32 ms)
      ΓêÜ should return 401 for invalid credentials (12 ms)
      ΓêÜ should return 500 on internal server error (63 ms)
    logout
      ΓêÜ should logout successfully (4 ms)
      ΓêÜ should return 500 on session destroy error (17 ms)

PASS src/controllers/__tests__/settingsController.test.ts
  SettingsController
    getSystemSettings
      ΓêÜ should return system settings (6 ms)
      ΓêÜ should handle errors (66 ms)
    updateSystemSettings
      ΓêÜ should update system settings (5 ms)
      ΓêÜ should handle errors (8 ms)
    getUserSettings
      ΓêÜ should return user settings (2 ms)
      ΓêÜ should return 401 when not authenticated (3 ms)
      ΓêÜ should return empty object when no settings (22 ms)
    updateUserSettings
      ΓêÜ should update user settings (2 ms)
      ΓêÜ should return 401 when not authenticated (1 ms)

  console.error
    Error fetching task types: Error: DB error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\taskTypeController.test.ts:29:67)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      14 |     res.json(result);
      15 |   } catch (error) {
    > 16 |     console.error('Error fetching task types:', error);
         |             ^
      17 |     res.status(500).json({ error: 'Failed to fetch task types' });
      18 |   }
      19 | };

      at Object.error [as getTaskTypes] (controllers/taskTypeController.ts:16:13)
      at Object.<anonymous> (controllers/__tests__/taskTypeController.test.ts:30:7)

  console.error
    undefined

       8 |   next: NextFunction
       9 | ): Promise<void> => {
    > 10 |   console.error(err.stack);
         |           ^
      11 |
      12 |   // Default error status and message
      13 |   const status = err.status || 500;

      at error (middleware/errorHandler.ts:10:11)
      at Object.<anonymous> (middleware/__tests__/errorHandler.test.ts:32:23)

PASS src/controllers/__tests__/taskTypeController.test.ts
  TaskTypeController
    getTaskTypes
      ΓêÜ should return all task types (15 ms)
      ΓêÜ should handle errors (106 ms)
    getTaskTypeById
      ΓêÜ should return a task type (3 ms)
      ΓêÜ should return 404 when not found (10 ms)
    createTaskType
      ΓêÜ should create a task type (21 ms)
      ΓêÜ should return 400 when name is missing (3 ms)
      ΓêÜ should return 400 when color format is invalid (2 ms)
    updateTaskType
      ΓêÜ should update a task type (21 ms)
      ΓêÜ should return 404 when not found (8 ms)
    deleteTaskType
      ΓêÜ should delete a task type (2 ms)
      ΓêÜ should return 404 when not found (1 ms)

  console.error
    undefined

       8 |   next: NextFunction
       9 | ): Promise<void> => {
    > 10 |   console.error(err.stack);
         |           ^
      11 |
      12 |   // Default error status and message
      13 |   const status = err.status || 500;

      at error (middleware/errorHandler.ts:10:11)
      at Object.<anonymous> (middleware/__tests__/errorHandler.test.ts:47:23)

  console.error
    undefined

       8 |   next: NextFunction
       9 | ): Promise<void> => {
    > 10 |   console.error(err.stack);
         |           ^
      11 |
      12 |   // Default error status and message
      13 |   const status = err.status || 500;

      at error (middleware/errorHandler.ts:10:11)
      at Object.<anonymous> (middleware/__tests__/errorHandler.test.ts:63:23)

  console.error
    undefined

       8 |   next: NextFunction
       9 | ): Promise<void> => {
    > 10 |   console.error(err.stack);
         |           ^
      11 |
      12 |   // Default error status and message
      13 |   const status = err.status || 500;

      at error (middleware/errorHandler.ts:10:11)
      at Object.<anonymous> (middleware/__tests__/errorHandler.test.ts:74:23)

  console.error
    Error stack trace

       8 |   next: NextFunction
       9 | ): Promise<void> => {
    > 10 |   console.error(err.stack);
         |           ^
      11 |
      12 |   // Default error status and message
      13 |   const status = err.status || 500;

      at error (middleware/errorHandler.ts:10:11)
      at Object.<anonymous> (middleware/__tests__/errorHandler.test.ts:87:23)

  console.log
    Auth check - User found: { id: '1', login: 'test', role_id: 1 }

      at log (middleware/authMiddleware.ts:11:13)

  console.error
    Error stack trace

       8 |   next: NextFunction
       9 | ): Promise<void> => {
    > 10 |   console.error(err.stack);
         |           ^
      11 |
      12 |   // Default error status and message
      13 |   const status = err.status || 500;

      at error (middleware/errorHandler.ts:10:11)
      at Object.<anonymous> (middleware/__tests__/errorHandler.test.ts:104:23)

  console.log
    Session check - Session: { user: { id: '1', login: 'test', role_id: 1 } }

      at log (middleware/permissionMiddleware.ts:11:13)

PASS src/middleware/__tests__/errorHandler.test.ts
  ErrorHandler Middleware
    ΓêÜ should handle ValidationError (17 ms)
    ΓêÜ should handle UnauthorizedError (38 ms)
    ΓêÜ should handle generic errors with custom status (14 ms)
    ΓêÜ should default to 500 status when no status provided (7 ms)
    ΓêÜ should include stack trace in development mode (7 ms)
    ΓêÜ should not include stack trace in production mode (19 ms)

  console.log
    Session check - User: { id: '1', login: 'test', role_id: 1 }

      at log (middleware/permissionMiddleware.ts:12:13)

  console.log
    Auth check - No session or user found

      at log (middleware/authMiddleware.ts:14:13)

  console.log
    Auth check - No session or user found

      at log (middleware/authMiddleware.ts:14:13)

  console.log
    Session check - Session: { user: { id: '1', login: 'test', role_id: 1 } }

      at log (middleware/permissionMiddleware.ts:11:13)

PASS src/middleware/__tests__/authMiddleware.test.ts
  AuthMiddleware
    ΓêÜ should call next() when user is authenticated (58 ms)
    ΓêÜ should return 403 when no session exists (11 ms)
    ΓêÜ should return 403 when session has no user (5 ms)

  console.log
    Session check - User: { id: '1', login: 'test', role_id: 1 }

      at log (middleware/permissionMiddleware.ts:12:13)

  console.log
    Session check - Session: { user: undefined }

      at log (middleware/permissionMiddleware.ts:11:13)

  console.log
    Session check - User: undefined

      at log (middleware/permissionMiddleware.ts:12:13)

  console.log
    Session check - Session: { user: { id: '1', login: 'test', role_id: 1 } }

      at log (middleware/permissionMiddleware.ts:11:13)

  console.error
    Error: Session error
        at Object.get [as user] (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\sessionController.test.ts:90:28)
        at Object.user [as session] (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\sessionController.ts:11:21)
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\controllers\__tests__\sessionController.test.ts:94:31)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      15 |     }
      16 |   } catch (error) {
    > 17 |     console.error(error);
         |             ^
      18 |     res.status(500).json({
      19 |       error: 'Internal server error'
      20 |     });

      at Object.error [as session] (controllers/sessionController.ts:17:13)
      at Object.<anonymous> (controllers/__tests__/sessionController.test.ts:94:31)

  console.log
    Session check - User: { id: '1', login: 'test', role_id: 1 }

      at log (middleware/permissionMiddleware.ts:12:13)

PASS src/controllers/__tests__/sessionController.test.ts
  SessionController
    session
      ΓêÜ should return user data when session exists (6 ms)
      ΓêÜ should return 401 when no session exists (2 ms)
      ΓêÜ should return 500 on internal error (32 ms)

  console.error
    Permission check failed: Error: Database error
        at Object.<anonymous> (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\src\middleware\__tests__\permissionMiddleware.test.ts:72:68)
        at Promise.then.completed (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\Mihovil\Desktop\CS50\project_management_app\api\node_modules\jest-runner\build\testWorker.js:106:12)

      26 |       })
      27 |       .catch(error => {
    > 28 |         console.error('Permission check failed:', error);
         |                 ^
      29 |         res.status(500).json({ error: 'Internal server error' });
      30 |       });
      31 |   };

      at error (middleware/permissionMiddleware.ts:28:17)

PASS src/middleware/__tests__/permissionMiddleware.test.ts
  PermissionMiddleware
    ΓêÜ should call next() when user has permission (47 ms)
    ΓêÜ should return 403 when user does not have permission (29 ms)
    ΓêÜ should return 401 when user is not authenticated (8 ms)
    ΓêÜ should return 500 when permission check fails (42 ms)

FAIL src/__tests__/integration/auth/auth-flow.test.ts (23.599 s)
  Authentication Flow
    POST /api/auth/register
      ├ù should register a new user successfully (201 ms)
    POST /api/auth/login
      ├ù should login successfully with correct credentials (115 ms)

  ΓùÅ Authentication Flow ΓÇ║ POST /api/auth/register ΓÇ║ should register a new user successfully

    listen EADDRINUSE: address already in use :::5000

      86 |
      87 | // Start server
    > 88 | app.listen(config.port, () => {
         |     ^
      89 |   console.log(`Server is running on port ${config.port}`);
      90 | });
      91 |

      at Function.listen (../node_modules/express/lib/application.js:635:24)
      at Object.listen (app.ts:88:5)
      at Object.<anonymous> (__tests__/integration/auth/auth-flow.test.ts:2:1)

  ΓùÅ Authentication Flow ΓÇ║ POST /api/auth/register ΓÇ║ should register a new user successfully

    SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string

      22 |
      23 | export const clearTestData = async () => {
    > 24 |   await testPool.query('TRUNCATE users CASCADE');
         |   ^
      25 |   // Add more tables to clear as needed
      26 | };
      27 |

      at ../node_modules/pg-pool/index.js:45:11
      at clearTestData (__tests__/utils/test-helpers.ts:24:3)
      at Object.<anonymous> (__tests__/integration/auth/auth-flow.test.ts:7:5)

  ΓùÅ Authentication Flow ΓÇ║ POST /api/auth/login ΓÇ║ should login successfully with correct credentials

    SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string

      22 |
      23 | export const clearTestData = async () => {
    > 24 |   await testPool.query('TRUNCATE users CASCADE');
         |   ^
      25 |   // Add more tables to clear as needed
      26 | };
      27 |

      at ../node_modules/pg-pool/index.js:45:11
      at clearTestData (__tests__/utils/test-helpers.ts:24:3)
      at Object.<anonymous> (__tests__/integration/auth/auth-flow.test.ts:7:5)

A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.
----------------------------|---------|----------|---------|---------|-------------------------------------------------------------------------------------------------------
File                        | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s                                                                                     
----------------------------|---------|----------|---------|---------|-------------------------------------------------------------------------------------------------------
All files                   |   83.54 |    68.07 |   53.61 |   81.63 |                                                                                                       
 src                        |    90.9 |     62.5 |       0 |    90.9 |                                                                                                       
  app.ts                    |   90.19 |        0 |       0 |   90.19 | 52,60-63,89                                                                                           
  config.ts                 |     100 |    83.33 |     100 |     100 | 12                                                                                                    
 src/__tests__/utils        |    64.7 |      100 |      25 |   53.84 |                                                                                                       
  test-helpers.ts           |    64.7 |      100 |      25 |   53.84 | 6-10,14-20,29-33                                                                                      
 src/controllers            |   91.73 |    82.26 |   98.94 |   90.83 |                                                                                                       
  activityTypeController.ts |   75.51 |       65 |      80 |   72.72 | 48-58,92-93,108,123-133                                                                               
  adminController.ts        |     100 |      100 |     100 |     100 |                                                                                                       
  commentController.ts      |     100 |       60 |     100 |     100 | 17,42                                                                                                 
  fileController.ts         |   96.66 |       90 |     100 |   96.42 | 93-94                                                                                                 
  loginController.ts        |     100 |      100 |     100 |     100 |                                                                                                       
  notificationController.ts |     100 |      100 |     100 |     100 |                                                                                                       
  profileController.ts      |   77.58 |    42.85 |     100 |   75.47 | 55-56,73,88-100,116,124-125,141                                                                       
  projectController.ts      |     100 |    92.85 |     100 |     100 | 142                                                                                                   
  roleController.ts         |     100 |      100 |     100 |     100 |                                                                                                       
  sessionController.ts      |     100 |      100 |     100 |     100 |                                                                                                       
  settingsController.ts     |   88.57 |      100 |     100 |   87.09 | 51-52,70-71                                                                                           
  tagController.ts          |   84.37 |      100 |     100 |   82.45 | 62-63,78-79,94-95,111-112,127-128                                                                     
  taskController.ts         |   79.19 |       64 |     100 |    77.2 | 42-43,62-63,82-83,156,167,170,182-185,216-217,240-249,263-264,283-284,298-299,312-313,318-319,334-335 
  taskTypeController.ts     |   84.31 |    95.45 |     100 |    82.6 | 37-38,78-79,109-110,130-131                                                                           
  timeLogController.ts      |     100 |      100 |     100 |     100 |                                                                                                       
  userController.ts         |     100 |      100 |     100 |     100 |                                                                                                       
  watcherController.ts      |     100 |      100 |     100 |     100 |                                                                                                       
 src/middleware             |   97.43 |    92.85 |    87.5 |   97.43 |                                                                                                       
  authMiddleware.ts         |     100 |      100 |     100 |     100 |                                                                                                       
  errorHandler.ts           |     100 |     87.5 |     100 |     100 | 14                                                                                                    
  permissionMiddleware.ts   |     100 |      100 |     100 |     100 |                                                                                                       
  sessionMiddleware.ts      |   83.33 |      100 |      50 |   83.33 | 18                                                                                                    
 src/models                 |   76.41 |    44.08 |   56.86 |   70.11 |                                                                                                       
  activityTypeModel.ts      |      50 |        0 |       0 |   33.33 | 6-11,22-29,41-48,53-60                                                                                
  adminModel.ts             |   36.36 |        0 |       0 |   22.22 | 9-13,18-19,29-49,54-60                                                                                
  commentModel.ts           |      50 |        0 |       0 |   33.33 | 9-15,25-31,39-45,54-60,68-74                                                                          
  fileModel.ts              |   53.33 |        0 |       0 |   36.36 | 9-13,27-40,48-53,61                                                                                   
  loginModel.ts             |     100 |      100 |     100 |     100 |                                                                                                       
  notificationModel.ts      |   52.63 |      100 |       0 |   35.71 | 9-15,23-31,39,52-56,64-68                                                                             
  permissionModel.ts        |     100 |      100 |     100 |     100 |                                                                                                       
  profileModel.ts           |      48 |        0 |       0 |   31.57 | 11-17,26-36,45-49,58-66,74-78,86-90                                                                   
  projectModel.ts           |   98.57 |    68.75 |   93.75 |   98.24 | 191                                                                                                   
  roleModel.ts              |     100 |      100 |     100 |     100 |                                                                                                       
  settingsModel.ts          |     100 |       75 |     100 |     100 | 37,73                                                                                                 
  tagModel.ts               |     100 |       75 |     100 |     100 | 97                                                                                                    
  taskModel.ts              |   34.37 |        0 |       0 |   20.75 | 17-34,42-47,71-99,108-145,154-161,169-176,183-187,194-198,206-212,220-226,234-240                     
  taskTypeModel.ts          |     100 |      100 |     100 |     100 |                                                                                                       
  timeLogModel.ts           |     100 |      100 |     100 |     100 |                                                                                                       
  userModel.ts              |     100 |      100 |     100 |     100 |                                                                                                       
  watcherModel.ts           |     100 |      100 |     100 |     100 |                                                                                                       
 src/routes                 |   66.03 |        0 |   14.28 |   66.03 |                                                                                                       
  activityTypeRouter.ts     |   68.75 |      100 |   16.66 |   68.75 | 11,15,19,23,27                                                                                        
  adminRouter.ts            |   76.92 |      100 |      25 |   76.92 | 12,17,22                                                                                              
  commentRouter.ts          |   69.23 |      100 |      20 |   69.23 | 11,15,19,23                                                                                           
  fileRouter.ts             |   63.33 |        0 |    12.5 |   63.33 | 13,19-23,35-38,43,48,52,56                                                                            
  loginRouter.ts            |   85.71 |      100 |      50 |   85.71 | 11                                                                                                    
  logoutRouter.ts           |   85.71 |      100 |      50 |   85.71 | 9                                                                                                     
  notificationRouter.ts     |   72.72 |      100 |      25 |   72.72 | 11,15,19                                                                                              
  profileRouter.ts          |   66.66 |      100 |   16.66 |   66.66 | 10,14,18,22,26                                                                                        
  projectRouter.ts          |   59.45 |      100 |    6.25 |   59.45 | 14,18,22,26,32,39,46,53,59,63,69,76,81,85,89                                                          
  roleRouter.ts             |      75 |      100 |      25 |      75 | 12,16,20                                                                                              
  sessionRouter.ts          |   85.71 |      100 |      50 |   85.71 | 10                                                                                                    
  settingsRouter.ts         |   71.42 |      100 |      20 |   71.42 | 11,16,20,24                                                                                           
  tagRouter.ts              |   69.23 |      100 |      20 |   69.23 | 11,15,19,23                                                                                           
  taskRouter.ts             |   57.37 |      100 |       4 |   57.37 | 20,23,26,29,32,35,39,42,45,48,51,55-56,61-62,67,71,75,78,81,85,88,91,94,97,100                        
  taskTypeRouter.ts         |   68.75 |      100 |   16.66 |   68.75 | 11,15,19,23,27                                                                                        
  timeLogRouter.ts          |    62.5 |      100 |      10 |    62.5 | 11,15,19,23,27,31,35,41,47                                                                            
  userRouter.ts             |   63.63 |      100 |   11.11 |   63.63 | 12,16,20,24,28,32,36,40                                                                               
 src/types                  |     100 |      100 |     100 |     100 |                                                                                                       
  notification.ts           |     100 |      100 |     100 |     100 |                                                                                                       
----------------------------|---------|----------|---------|---------|-------------------------------------------------------------------------------------------------------
Summary of all failing tests
FAIL controllers/__tests__/activityTypeController.test.ts (18.679 s)
  ΓùÅ ActivityTypeController ΓÇ║ getActivityTypes ΓÇ║ should handle errors appropriately

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    - Expected
    + Received

      Object {
    -   "error": "Internal server error",
    +   "error": "Failed to fetch activity types",
      },

    Number of calls: 1

      102 |       expect(activityTypeModel.getActivityTypes).toHaveBeenCalledWith(mockPool);
      103 |       expect(mockRes.status).toHaveBeenCalledWith(500);
    > 104 |       expect(mockRes.json).toHaveBeenCalledWith({ error: 'Internal server error' });
          |                            ^
      105 |     });
      106 |   });
      107 |

      at Object.<anonymous> (controllers/__tests__/activityTypeController.test.ts:104:28)

  ΓùÅ ActivityTypeController ΓÇ║ createActivityType ΓÇ║ should create an activity type

    expect(jest.fn()).toHaveBeenCalled()

    Expected number of calls: >= 1
    Received number of calls:    0

      129 |         );
      130 |
    > 131 |       expect(activityTypeModel.createActivityType).toHaveBeenCalled();
          |                                                    ^
      132 |       expect(activityTypeModel.createActivityType).toHaveBeenCalledWith(mockPool, mockActivityTypeData);
      133 |       expect(mockRes.status).toHaveBeenCalledWith(201);
      134 |       expect(mockRes.json).toHaveBeenCalledWith(createdActivityType);

      at Object.<anonymous> (controllers/__tests__/activityTypeController.test.ts:131:52)

  ΓùÅ ActivityTypeController ΓÇ║ createActivityType ΓÇ║ should return 400 if the user is not authenticated

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: 400
    Received: 401

    Number of calls: 1

      146 |       );
      147 |
    > 148 |       expect(mockRes.status).toHaveBeenCalledWith(400);
          |                              ^
      149 |       expect(mockRes.json).toHaveBeenCalledWith(
      150 |         expect.objectContaining({
      151 |           error: 'User not authenticated'

      at Object.<anonymous> (controllers/__tests__/activityTypeController.test.ts:148:30)

  ΓùÅ ActivityTypeController ΓÇ║ updateActivityType ΓÇ║ should update an activity type successfully

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    - Expected
    + Received

      {},
      "1",
    - {"name": "Updated Activity Type"},
    + "Updated Activity Type",
    + "",
    + "",
    + "",

    Number of calls: 1

      202 |       );
      203 |
    > 204 |       expect(activityTypeModel.updateActivityType).toHaveBeenCalledWith(mockPool, activityTypeId, mockUpdateData);
          |                                                    ^
      205 |       expect(mockRes.status).toHaveBeenCalledWith(200);
      206 |       expect(mockRes.json).toHaveBeenCalledWith(updatedActivityType);
      207 |     });

      at Object.<anonymous> (controllers/__tests__/activityTypeController.test.ts:204:52)

  ΓùÅ ActivityTypeController ΓÇ║ deleteActivityType ΓÇ║ should delete an activity type successfully

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    - Expected
    + Received

      Object {
    -   "success": true,
    +   "message": "Activity type deleted successfully",
      },

    Number of calls: 1

      237 |       expect(activityTypeModel.deleteActivityType).toHaveBeenCalledWith(mockPool, activityTypeId);
      238 |       expect(mockRes.status).toHaveBeenCalledWith(200);
    > 239 |       expect(mockRes.json).toHaveBeenCalledWith({ success: true });
          |                            ^
      240 |     });
      241 |
      242 |     it('should handle errors appropriately', async () => {

      at Object.<anonymous> (controllers/__tests__/activityTypeController.test.ts:239:28)

  ΓùÅ ActivityTypeController ΓÇ║ deleteActivityType ΓÇ║ should handle errors appropriately

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    - Expected
    + Received

      Object {
    -   "error": "Internal server error",
    +   "error": "Failed to delete activity type",
      },

    Number of calls: 1

      251 |
      252 |       expect(mockRes.status).toHaveBeenCalledWith(500);
    > 253 |       expect(mockRes.json).toHaveBeenCalledWith({ error: 'Internal server error' });
          |                            ^
      254 |     });
      255 |   });
      256 |

      at Object.<anonymous> (controllers/__tests__/activityTypeController.test.ts:253:28)

  ΓùÅ ActivityTypeController ΓÇ║ getAvailableIcons ΓÇ║ should return a list of available icons

    TypeError: activityTypeController.getAvailableIcons.mockResolvedValue is not a function

      262 |         'cloud', 'support', 'more_horiz'
      263 |     ];
    > 264 |       (activityTypeController.getAvailableIcons as jest.Mock).mockResolvedValue(mockIcons);
          |                                                               ^
      265 |
      266 |       await activityTypeController.getAvailableIcons(
      267 |         mockReq as Request,

      at Object.<anonymous> (controllers/__tests__/activityTypeController.test.ts:264:63)

  ΓùÅ ActivityTypeController ΓÇ║ getAvailableIcons ΓÇ║ should handle errors appropriately

    TypeError: activityTypeController.getAvailableIcons.mockRejectedValue is not a function

      274 |
      275 |     it('should handle errors appropriately', async () => {
    > 276 |       (activityTypeController.getAvailableIcons as jest.Mock).mockRejectedValue(new Error('Failed to fetch icons error'));
          |                                                               ^
      277 |
      278 |       await activityTypeController.getAvailableIcons(
      279 |         mockReq as Request,

      at Object.<anonymous> (controllers/__tests__/activityTypeController.test.ts:276:63)

FAIL controllers/__tests__/taskController.test.ts (19.202 s)
  ΓùÅ TaskController ΓÇ║ getTaskByAssignee ΓÇ║ should return tasks for a given assignee

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    - Expected
    + Received

      {},
      Object {
    -   "assignee_id": "123",
    +   "assignee_id": 123,
      },

    Number of calls: 1

      212 |       );
      213 |
    > 214 |       expect(taskModel.getTasks).toHaveBeenCalledWith(mockPool, { assignee_id: assigneeId });
          |                                  ^
      215 |       expect(mockRes.status).toHaveBeenCalledWith(200);
      216 |       expect(mockRes.json).toHaveBeenCalledWith(mockTasks);
      217 |     });

      at Object.<anonymous> (controllers/__tests__/taskController.test.ts:214:34)

  ΓùÅ TaskController ΓÇ║ getTaskByHolder ΓÇ║ should return tasks for a given holder

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    - Expected
    + Received

      {},
      Object {
    -   "holder_id": "123",
    +   "holder_id": 123,
      },

    Number of calls: 1

      260 |       );
      261 |
    > 262 |       expect(taskModel.getTasks).toHaveBeenCalledWith(mockPool, { holder_id: holderId });
          |                                  ^
      263 |       expect(mockRes.status).toHaveBeenCalledWith(200);
      264 |       expect(mockRes.json).toHaveBeenCalledWith(mockTasks);
      265 |     });

      at Object.<anonymous> (controllers/__tests__/taskController.test.ts:262:34)

  ΓùÅ TaskController ΓÇ║ changeTaskStatus ΓÇ║ should change task status successfully

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: {}, "123", {"status_id": "2"}

    Number of calls: 0

      425 |       );
      426 |
    > 427 |       expect(taskModel.updateTask).toHaveBeenCalledWith(mockPool, taskId, { status_id: newStatusId });
          |                                    ^
      428 |       expect(mockRes.status).toHaveBeenCalledWith(200);
      429 |       expect(mockRes.json).toHaveBeenCalledWith(updatedTask);
      430 |     });

      at Object.<anonymous> (controllers/__tests__/taskController.test.ts:427:36)

  ΓùÅ TaskController ΓÇ║ changeTaskStatus ΓÇ║ should return 404 when task is not found

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    - Expected
    + Received

      Object {
    -   "error": "Task not found",
    +   "error": "Unable to update task status",
      },

    Number of calls: 1

      442 |
      443 |       expect(mockRes.status).toHaveBeenCalledWith(404);
    > 444 |       expect(mockRes.json).toHaveBeenCalledWith({ error: 'Task not found' });
          |                            ^
      445 |     });
      446 |   });
      447 |

      at Object.<anonymous> (controllers/__tests__/taskController.test.ts:444:28)

FAIL controllers/__tests__/adminController.test.ts (19.569 s)
  ΓùÅ AdminController ΓÇ║ checkAdminAccess ΓÇ║ should return 401 when user is not authenticated

    expect(received).toEqual(expected) // deep equality

    Expected: Any<Object>
    Received: undefined

      86 |       expect(mockRes.status).toHaveBeenCalledWith(401);
      87 |       expect(mockRes.json).toHaveBeenCalledWith({ error: 'User not authenticated' });
    > 88 |       expect(result).toEqual(expect.any(Object));
         |                      ^
      89 |     });
      90 |
      91 |     it('should return 403 when user is not admin', async () => {

      at Object.<anonymous> (controllers/__tests__/adminController.test.ts:88:22)

  ΓùÅ AdminController ΓÇ║ checkAdminAccess ΓÇ║ should return 403 when user is not admin

    expect(received).toEqual(expected) // deep equality

    Expected: Any<Object>
    Received: undefined

      100 |       expect(mockRes.status).toHaveBeenCalledWith(403);
      101 |       expect(mockRes.json).toHaveBeenCalledWith({ error: 'Access denied' });
    > 102 |       expect(result).toEqual(expect.any(Object));
          |                      ^
      103 |     });
      104 |
      105 |     it('should handle errors appropriately', async () => {

      at Object.<anonymous> (controllers/__tests__/adminController.test.ts:102:22)

  ΓùÅ AdminController ΓÇ║ getSystemLogs ΓÇ║ should return system logs successfully

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: [{"activity_name": "login", "activity_type_id": 1, "created_on": 2026-01-18T23:41:29.204Z, "description": "User logged in", "id": 1, "user_id": 1, "user_login": "test"}]
    Received: undefined

    Number of calls: 1

      178 |
      179 |       expect(mockRes.status).toHaveBeenCalledWith(200);
    > 180 |       expect(mockRes.json).toHaveBeenCalledWith(mockLogs);
          |                            ^
      181 |       expect(adminModel.getSystemLogs).toHaveBeenCalledWith(
      182 |         mockPool,
      183 |         mockQuery.startDate,

      at Object.<anonymous> (controllers/__tests__/adminController.test.ts:180:28)

  ΓùÅ AdminController ΓÇ║ getSystemLogs ΓÇ║ should handle empty query parameters

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: [{"activity_name": "login", "activity_type_id": 1, "created_on": 2026-01-18T23:41:29.204Z, "description": "User logged in", "id": 1, "user_id": 1, "user_login": "test"}]
    Received: undefined

    Number of calls: 1

      195 |
      196 |       expect(mockRes.status).toHaveBeenCalledWith(200);
    > 197 |       expect(mockRes.json).toHaveBeenCalledWith(mockLogs);
          |                            ^
      198 |       expect(adminModel.getSystemLogs).toHaveBeenCalledWith(
      199 |         mockPool,
      200 |         undefined,

      at Object.<anonymous> (controllers/__tests__/adminController.test.ts:197:28)

FAIL controllers/__tests__/profileController.test.ts (20.027 s)
  ΓùÅ Profile Controller ΓÇ║ getProfile ΓÇ║ should handle case when profile is not found

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: 404
    Received: 200

    Number of calls: 1

      135 |
      136 |       expect(getProfileSpy).toHaveBeenCalledWith(mockPool, '1');
    > 137 |       expect(mockStatus).toHaveBeenCalledWith(404);
          |                          ^
      138 |       expect(mockJson).toHaveBeenCalledWith({ error: 'Profile not found' });
      139 |     });
      140 |   });

      at Object.<anonymous> (controllers/__tests__/profileController.test.ts:137:26)

  ΓùÅ Profile Controller ΓÇ║ updateProfile ΓÇ║ should handle case when profile update fails

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: 404
    Received: 200

    Number of calls: 1

      226 |         expect.objectContaining({ name: 'New Name' })
      227 |       );
    > 228 |       expect(mockStatus).toHaveBeenCalledWith(404);
          |                          ^
      229 |       expect(mockJson).toHaveBeenCalledWith({ error: 'Profile not found' });
      230 |     });
      231 |   });

      at Object.<anonymous> (controllers/__tests__/profileController.test.ts:228:26)

  ΓùÅ Profile Controller ΓÇ║ changePassword ΓÇ║ should update password with valid input

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: {}, "1", "oldPass123", "newPass123"

    Number of calls: 0

      314 |       await changePassword(mockRequest as Request, mockResponse, mockPool);
      315 |
    > 316 |       expect(profileModel.changePassword).toHaveBeenCalledWith(
          |                                           ^
      317 |         mockPool,
      318 |         '1',
      319 |         'oldPass123',

      at Object.<anonymous> (controllers/__tests__/profileController.test.ts:316:43)

  ΓùÅ Profile Controller ΓÇ║ changePassword ΓÇ║ should return 400 with invalid passwords

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    - Expected
    + Received

      Object {
    -   "error": "Invalid password format",
    +   "error": "Current password is incorrect",
      },

    Number of calls: 1

      329 |
      330 |       expect(mockStatus).toHaveBeenCalledWith(400);
    > 331 |       expect(mockJson).toHaveBeenCalledWith({ error: 'Invalid password format' });
          |                        ^
      332 |     });
      333 |
      334 |     it('should handle incorrect old password', async () => {

      at Object.<anonymous> (controllers/__tests__/profileController.test.ts:331:24)

  ΓùÅ Profile Controller ΓÇ║ changePassword ΓÇ║ should handle incorrect old password

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: 401
    Received: 400

    Number of calls: 1

      341 |       await changePassword(mockRequest as Request, mockResponse, mockPool);
      342 |
    > 343 |       expect(mockStatus).toHaveBeenCalledWith(401);
          |                          ^
      344 |       expect(mockJson).toHaveBeenCalledWith({ error: 'Invalid old password' });
      345 |     });
      346 |   });

      at Object.<anonymous> (controllers/__tests__/profileController.test.ts:343:26)

FAIL __tests__/integration/auth/auth-flow.test.ts (23.599 s)
  ΓùÅ Authentication Flow ΓÇ║ POST /api/auth/register ΓÇ║ should register a new user successfully

    listen EADDRINUSE: address already in use :::5000

      86 |
      87 | // Start server
    > 88 | app.listen(config.port, () => {
         |     ^
      89 |   console.log(`Server is running on port ${config.port}`);
      90 | });
      91 |

      at Function.listen (../node_modules/express/lib/application.js:635:24)
      at Object.listen (app.ts:88:5)
      at Object.<anonymous> (__tests__/integration/auth/auth-flow.test.ts:2:1)

  ΓùÅ Authentication Flow ΓÇ║ POST /api/auth/register ΓÇ║ should register a new user successfully

    SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string

      22 |
      23 | export const clearTestData = async () => {
    > 24 |   await testPool.query('TRUNCATE users CASCADE');
         |   ^
      25 |   // Add more tables to clear as needed
      26 | };
      27 |

      at ../node_modules/pg-pool/index.js:45:11
      at clearTestData (__tests__/utils/test-helpers.ts:24:3)
      at Object.<anonymous> (__tests__/integration/auth/auth-flow.test.ts:7:5)

  ΓùÅ Authentication Flow ΓÇ║ POST /api/auth/login ΓÇ║ should login successfully with correct credentials

    SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string

      22 |
      23 | export const clearTestData = async () => {
    > 24 |   await testPool.query('TRUNCATE users CASCADE');
         |   ^
      25 |   // Add more tables to clear as needed
      26 | };
      27 |

      at ../node_modules/pg-pool/index.js:45:11
      at clearTestData (__tests__/utils/test-helpers.ts:24:3)
      at Object.<anonymous> (__tests__/integration/auth/auth-flow.test.ts:7:5)


Test Suites: 5 failed, 26 passed, 31 total
Tests:       23 failed, 294 passed, 317 total
Snapshots:   0 total
Time:        27.832 s
Ran all test suites.
